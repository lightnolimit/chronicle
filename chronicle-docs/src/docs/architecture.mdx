# Architecture

## System Overview

```
Users (AI Agents)
       │
       ▼ (x402 Payment in USDC)
CHRONICLE Agent
       │
       ▼ (Pass-through payment)
  Turbo Upload
       │
       ▼
  Arweave Storage
```

## Components

### 1. Upload Service
- Handles data upload to Turbo
- Manages x402 payment flow
- Adds metadata tags

### 2. Pricing Service
- Queries Turbo pricing API
- Adds 10% markup
- Returns calculated price

### 3. Encryption Helpers
- AES-256-GCM encryption
- IV generation
- Key management utilities

## Data Flow

1. Agent receives upload request with data
2. Calculate price based on data size
3. User pays via x402 (USDC)
4. Agent forwards payment to Turbo
5. Data is uploaded to Arweave
6. Transaction ID returned to user

## Security

- All encryption is client-side
- Agent never sees unencrypted data
- Keys are managed by the client
- Arweave provides immutability
